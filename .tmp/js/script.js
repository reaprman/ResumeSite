"use strict";var _this = void 0;var slideIdx = 1;
var slides = document.getElementsByClassName('item');
var dots = document.getElementsByClassName('dot');
var firstRun = true;
var prevFocusedElement;
var firstFocus;
var modal = document.getElementById('modal');

AOS.init();
document.addEventListener('DOMContentLoaded', function (event) {
  rage();
  modalTrap();
});
document.getElementsByClassName("mobile-nav-icon")[0].addEventListener("click", function () {
  var nav = document.getElementsByClassName("main-nav")[0];
  if (nav.style.display == "none" || nav.style.display == "") {
    nav.style.display = "inline-block";
  } else {
    nav.style.display = "none";
  }

  var icon = document.querySelector(".mobile-nav-icon i");
  if (icon.classList.contains("ion-md-menu")) {
    icon.classList.toggle("ion-md-menu");
    icon.classList.toggle("ion-md-close");
  } else {
    icon.classList.toggle("ion-md-menu");
    icon.classList.toggle("ion-md-close");
  }

  if (modal.classList.contains('show-modal')) {
    //modal.classList.toggle('show-modal');
    // fix it here
    modalToggle(_this.id);
  }
});

var rage = function rage() {

  window.addEventListener('click', function (event) {
    if (event.target.id == "modal") {
      modalToggle(this.id);
    }
  });
};

document.getElementsByClassName("main-nav")[0].addEventListener('click', function () {
  if (modal.classList.contains('show-modal')) {
    modalToggle(_this.id);
  }
});
var modalTrap = function modalTrap() {
  var focusableElementString = 'a[href], button:not([disabled])';
  var focusableElement = modal.querySelectorAll(focusableElementString);
  focusableElement = Array.prototype.slice.call(focusableElement);
  firstFocus = focusableElement[0];
  var lastFocus = focusableElement[focusableElement.length - 1];
  modal.addEventListener('keydown', trapTapKey);

  function trapTapKey(event) {
    if (event.keyCode == 9) {
      if (event.shiftKey) {
        if (document.activeElement == firstFocus) {
          event.preventDefault();
          lastFocus.focus();
        }
      } else {
        if (document.activeElement == lastFocus) {
          event.preventDefault();
          firstFocus.focus();
        }
      }
    }
    if (event.keyCode == 39) {
      modalArrows(1);
    }
    if (event.keyCode == 37) {
      modalArrows(-1);
    }
    if (event.keyCode == 27) {
      modalToggle(this.id);
    }
  }
};

function modalToggle(imgPath) {
  prevFocusedElement = document.activeElement;
  slides[slideIdx - 1].classList.add('active');
  dots[slideIdx - 1].classList.add('dot-active');
  if (!modal.classList.contains('show-modal')) {
    fillModalImg(imgPath);
  }
  var icon = document.querySelector(".mobile-nav-icon i");
  var nav = document.getElementsByClassName("main-nav")[0];
  if (icon.classList.contains('ion-md-close') && firstRun == true) {
    nav.style.display = "none";
    icon.classList.toggle("ion-md-menu");
    icon.classList.toggle("ion-md-close");
  }

  modal.classList.toggle('show-modal');
  if (!firstRun) {
    slides[slideIdx - 1].classList.remove('active');
    dots[slideIdx - 1].classList.remove('dot-active');
    slideIdx = 1;
    firstRun = true;
    return;
  }
  firstRun = false;
}

function fillModalImg(imgPath) {
  var imgArr = imgPath.split(".");
  var imgArr2 = imgArr[2].split("/");
  var imgName = imgArr2[3].slice(0, -1);
  var img1 = "app/img/".concat(imgName, "1.").concat(imgArr[3]);
  var img2 = "app/img/".concat(imgName, "2.").concat(imgArr[3]);
  var img3 = "app/img/".concat(imgName, "3.").concat(imgArr[3]);

  var imgModal1 = document.getElementById('mPic1');
  var imgModal2 = document.getElementById('mPic2');
  var imgModal3 = document.getElementById('mPic3');

  imgModal1.src = img1;
  imgModal2.src = img2;
  imgModal3.src = img3;

}

function modalArrows(direction) {
  displayModal(slideIdx += direction);
}

function modalSelect(selection) {
  slideIdx = selection;
  displayModal(selection);
}

function displayModal(idx) {

  if (idx > slides.length) {
    slideIdx = 1;
  }
  if (idx == 0) {slideIdx = slides.length;}
  for (i = 0; i < slides.length; i++) {
    if (slides[i].classList.contains('active')) {
      slides[i].classList.remove('active');
      slides[slideIdx - 1].classList.add('active');
      dots[i].classList.remove('dot-active');
      dots[slideIdx - 1].classList.add('dot-active');
      return;
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJzbGlkZUlkeCIsInNsaWRlcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImRvdHMiLCJmaXJzdFJ1biIsInByZXZGb2N1c2VkRWxlbWVudCIsImZpcnN0Rm9jdXMiLCJtb2RhbCIsImdldEVsZW1lbnRCeUlkIiwiQU9TIiwiaW5pdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInJhZ2UiLCJtb2RhbFRyYXAiLCJuYXYiLCJzdHlsZSIsImRpc3BsYXkiLCJpY29uIiwicXVlcnlTZWxlY3RvciIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwidG9nZ2xlIiwibW9kYWxUb2dnbGUiLCJpZCIsIndpbmRvdyIsInRhcmdldCIsImZvY3VzYWJsZUVsZW1lbnRTdHJpbmciLCJmb2N1c2FibGVFbGVtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJjYWxsIiwibGFzdEZvY3VzIiwibGVuZ3RoIiwidHJhcFRhcEtleSIsImtleUNvZGUiLCJzaGlmdEtleSIsImFjdGl2ZUVsZW1lbnQiLCJwcmV2ZW50RGVmYXVsdCIsImZvY3VzIiwibW9kYWxBcnJvd3MiLCJpbWdQYXRoIiwiYWRkIiwiZmlsbE1vZGFsSW1nIiwicmVtb3ZlIiwiaW1nQXJyIiwic3BsaXQiLCJpbWdBcnIyIiwiaW1nTmFtZSIsImltZzEiLCJpbWcyIiwiaW1nMyIsImltZ01vZGFsMSIsImltZ01vZGFsMiIsImltZ01vZGFsMyIsInNyYyIsImRpcmVjdGlvbiIsImRpc3BsYXlNb2RhbCIsIm1vZGFsU2VsZWN0Iiwic2VsZWN0aW9uIiwiaWR4IiwiaSJdLCJtYXBwaW5ncyI6ImdDQUFBLElBQUlBLFFBQVEsR0FBRyxDQUFmO0FBQ0EsSUFBSUMsTUFBTSxHQUFHQyxRQUFRLENBQUNDLHNCQUFULENBQWdDLE1BQWhDLENBQWI7QUFDQSxJQUFJQyxJQUFJLEdBQUdGLFFBQVEsQ0FBQ0Msc0JBQVQs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U0FBU0UsV0FBVCxDQUFxQkMsU0FBckIsRUFBK0I7QUFDM0I5RCxFQUFBQSxRQUFRLEdBQUc4RCxTQUFYO0FBQ0FGLEVBQUFBLFlBQVksQ0FBQ0UsU0FBRCxDQUFaO0FBQ0g7O0FBRUQsU0FBU0YsWUFBVCxDQUFzQkcsR0FBdEIsRUFBMEI7O0FBRXRCLE1BQUdBLEdBQUcsR0FBRzlELE1BQU0sQ0FBQ21DLE1BQWhCLEVBQXVCO0FBQ25CcEMsSUFBQUEsUUFBUSxHQUFHLENBQVg7QUFDSDtBQUNELE1BQUcrRCxHQUFHLElBQUksQ0FBVixFQUFZLENBQUUvRCxRQUFRLEdBQUdDLE1BQU0sQ0FBQ21DLE1BQWxCLENBQTBCO0FBQ3hDLE9BQUs0QixDQUFDLEdBQUcsQ0FBVCxFQUFZQSxDQUFDLEdBQUcvRCxNQUFNLENBQUNtQyxNQUF2QixFQUErQjRCLENBQUMsRUFBaEMsRUFBbUM7QUFDL0IsUUFBRy9ELE1BQU0sQ0FBQytELENBQUQsQ0FBTixDQUFVM0MsU0FBVixDQUFvQkMsUUFBcEIsQ0FBNkIsUUFBN0IsQ0FBSCxFQUEwQztBQUN0Q3JCLE1BQUFBLE1BQU0sQ0FBQytELENBQUQsQ0FBTixDQUFVM0MsU0FBVixDQUFvQjBCLE1BQXBCLENBQTJCLFFBQTNCO0FBQ0E5QyxNQUFBQSxNQUFNLENBQUNELFFBQVEsR0FBQyxDQUFWLENBQU4sQ0FBbUJxQixTQUFuQixDQUE2QndCLEdBQTdCLENBQWlDLFFBQWpDO0FBQ0F6QyxNQUFBQSxJQUFJLENBQUM0RCxDQUFELENBQUosQ0FBUTNDLFNBQVIsQ0FBa0IwQixNQUFsQixDQUF5QixZQUF6QjtBQUNBM0MsTUFBQUEsSUFBSSxDQUFDSixRQUFRLEdBQUMsQ0FBVixDQUFKLENBQWlCcUIsU0FBakIsQ0FBMkJ3QixHQUEzQixDQUErQixZQUEvQjtBQUNBO0FBQ0g7QUFDSjtBQUNKIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHNsaWRlSWR4ID0gMTtcclxubGV0IHNsaWRlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2l0ZW0nKTtcclxubGV0IGRvdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkb3QnKTtcclxubGV0IGZpcnN0UnVuID0gdHJ1ZTtcclxubGV0IHByZXZGb2N1c2VkRWxlbWVudDtcclxubGV0IGZpcnN0Rm9jdXM7XHJcbmNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vZGFsJyk7XHJcblxyXG5BT1MuaW5pdCgpO1xyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgKGV2ZW50KSA9PiB7XHJcbiAgICByYWdlKCk7XHJcbiAgICBtb2RhbFRyYXAoKTsgXHJcbn0pO1xyXG5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibW9iaWxlLW5hdi1pY29uXCIpWzBdLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PntcclxuICAgIGxldCBuYXYgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibWFpbi1uYXZcIilbMF07XHJcbiAgICBpZihuYXYuc3R5bGUuZGlzcGxheSA9PSBcIm5vbmVcIiB8fCBuYXYuc3R5bGUuZGlzcGxheSA9PSBcIlwiKXtcclxuICAgICAgICBuYXYuc3R5bGUuZGlzcGxheSA9IFwiaW5saW5lLWJsb2NrXCI7XHJcbiAgICB9ZWxzZXtcclxuICAgICAgICBuYXYuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBpY29uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2JpbGUtbmF2LWljb24gaVwiKTtcclxuICAgIGlmKGljb24uY2xhc3NMaXN0LmNvbnRhaW5zKFwiaW9uLW1kLW1lbnVcIikpe1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1tZW51XCIpO1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1jbG9zZVwiKTtcclxuICAgIH1lbHNle1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1tZW51XCIpO1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1jbG9zZVwiKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYobW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LW1vZGFsJykpe1xyXG4gICAgICAgIC8vbW9kYWwuY2xhc3NMaXN0LnRvZ2dsZSgnc2hvdy1tb2RhbCcpO1xyXG4gICAgICAgIC8vIGZpeCBpdCBoZXJlXHJcbiAgICAgICAgbW9kYWxUb2dnbGUodGhpcy5pZCk7XHJcbiAgICB9XHJcbn0pXHJcblxyXG5jb25zdCByYWdlID0gKCkgPT4ge1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KXtcclxuICAgICAgICBpZihldmVudC50YXJnZXQuaWQgPT1cIm1vZGFsXCIpe1xyXG4gICAgICAgICAgICBtb2RhbFRvZ2dsZSh0aGlzLmlkKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG59XHJcblxyXG5kb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibWFpbi1uYXZcIilbMF0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpID0+e1xyXG4gICAgaWYobW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LW1vZGFsJykpe1xyXG4gICAgICAgIG1vZGFsVG9nZ2xlKHRoaXMuaWQpO1xyXG4gICAgfVxyXG59KVxyXG5jb25zdCBtb2RhbFRyYXAgPSAoKSA9PiB7XHJcbiAgICBsZXQgZm9jdXNhYmxlRWxlbWVudFN0cmluZyA9ICdhW2hyZWZdLCBidXR0b246bm90KFtkaXNhYmxlZF0pJztcclxuICAgIGxldCBmb2N1c2FibGVFbGVtZW50ID0gbW9kYWwucXVlcnlTZWxlY3RvckFsbChmb2N1c2FibGVFbGVtZW50U3RyaW5nKTtcclxuICAgIGZvY3VzYWJsZUVsZW1lbnQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmb2N1c2FibGVFbGVtZW50KTtcclxuICAgIGZpcnN0Rm9jdXMgPSBmb2N1c2FibGVFbGVtZW50WzBdO1xyXG4gICAgbGV0IGxhc3RGb2N1cyA9IGZvY3VzYWJsZUVsZW1lbnRbZm9jdXNhYmxlRWxlbWVudC5sZW5ndGggLSAxXTtcclxuICAgIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0cmFwVGFwS2V5KTtcclxuXHJcbiAgICBmdW5jdGlvbiB0cmFwVGFwS2V5KGV2ZW50KXtcclxuICAgICAgICBpZihldmVudC5rZXlDb2RlID09IDkpe1xyXG4gICAgICAgICAgICBpZihldmVudC5zaGlmdEtleSl7XHJcbiAgICAgICAgICAgICAgICBpZihkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09IGZpcnN0Rm9jdXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFzdEZvY3VzLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZihkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09IGxhc3RGb2N1cyl7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBmaXJzdEZvY3VzLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYoZXZlbnQua2V5Q29kZSA9PSAzOSl7XHJcbiAgICAgICAgICAgIG1vZGFsQXJyb3dzKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihldmVudC5rZXlDb2RlID09IDM3KXtcclxuICAgICAgICAgICAgbW9kYWxBcnJvd3MoLTEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZihldmVudC5rZXlDb2RlID09IDI3KXtcclxuICAgICAgICAgICAgbW9kYWxUb2dnbGUodGhpcy5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBtb2RhbFRvZ2dsZShpbWdQYXRoKXtcclxuICAgIHByZXZGb2N1c2VkRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XHJcbiAgICBzbGlkZXNbc2xpZGVJZHgtMV0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICBkb3RzW3NsaWRlSWR4LTFdLmNsYXNzTGlzdC5hZGQoJ2RvdC1hY3RpdmUnKTtcclxuICAgIGlmKCFtb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctbW9kYWwnKSl7XHJcbiAgICAgICBmaWxsTW9kYWxJbWcoaW1nUGF0aCk7IFxyXG4gICAgfVxyXG4gICAgbGV0IGljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vYmlsZS1uYXYtaWNvbiBpXCIpO1xyXG4gICAgbGV0IG5hdiA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJtYWluLW5hdlwiKVswXTtcclxuICAgIGlmKGljb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdpb24tbWQtY2xvc2UnKSAmJiBmaXJzdFJ1biA9PSB0cnVlKXtcclxuICAgICAgICBuYXYuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1tZW51XCIpO1xyXG4gICAgICAgIGljb24uY2xhc3NMaXN0LnRvZ2dsZShcImlvbi1tZC1jbG9zZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBtb2RhbC5jbGFzc0xpc3QudG9nZ2xlKCdzaG93LW1vZGFsJyk7XHJcbiAgICBpZighZmlyc3RSdW4pe1xyXG4gICAgICAgIHNsaWRlc1tzbGlkZUlkeC0xXS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcclxuICAgICAgICBkb3RzW3NsaWRlSWR4LTFdLmNsYXNzTGlzdC5yZW1vdmUoJ2RvdC1hY3RpdmUnKTtcclxuICAgICAgICBzbGlkZUlkeCA9IDE7XHJcbiAgICAgICAgZmlyc3RSdW4gPSB0cnVlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGZpcnN0UnVuID0gZmFsc2U7IFxyXG59XHJcblxyXG5mdW5jdGlvbiBmaWxsTW9kYWxJbWcoaW1nUGF0aCl7XHJcbiAgICBsZXQgaW1nQXJyID0gaW1nUGF0aC5zcGxpdChcIi5cIik7XHJcbiAgICBsZXQgaW1nQXJyMiA9IGltZ0FyclsyXS5zcGxpdChcIi9cIik7XHJcbiAgICBsZXQgaW1nTmFtZSA9IGltZ0FycjJbM10uc2xpY2UoMCwgLTEpO1xyXG4gICAgbGV0IGltZzEgPSBgYXBwL2ltZy8ke2ltZ05hbWV9MS4ke2ltZ0FyclszXX1gO1xyXG4gICAgbGV0IGltZzIgPSBgYXBwL2ltZy8ke2ltZ05hbWV9Mi4ke2ltZ0FyclszXX1gO1xyXG4gICAgbGV0IGltZzMgPSBgYXBwL2ltZy8ke2ltZ05hbWV9My4ke2ltZ0FyclszXX1gO1xyXG5cclxuICAgIGNvbnN0IGltZ01vZGFsMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtUGljMScpO1xyXG4gICAgY29uc3QgaW1nTW9kYWwyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21QaWMyJyk7XHJcbiAgICBjb25zdCBpbWdNb2RhbDMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbVBpYzMnKTtcclxuXHJcbiAgICBpbWdNb2RhbDEuc3JjID0gaW1nMTtcclxuICAgIGltZ01vZGFsMi5zcmMgPSBpbWcyO1xyXG4gICAgaW1nTW9kYWwzLnNyYyA9IGltZzM7XHJcblxyXG59XHJcblxyXG5mdW5jdGlvbiBtb2RhbEFycm93cyhkaXJlY3Rpb24pIHtcclxuICAgIGRpc3BsYXlNb2RhbChzbGlkZUlkeCArPSBkaXJlY3Rpb24pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBtb2RhbFNlbGVjdChzZWxlY3Rpb24pe1xyXG4gICAgc2xpZGVJZHggPSBzZWxlY3Rpb247XHJcbiAgICBkaXNwbGF5TW9kYWwoc2VsZWN0aW9uKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGlzcGxheU1vZGFsKGlkeCl7XHJcblxyXG4gICAgaWYoaWR4ID4gc2xpZGVzLmxlbmd0aCl7XHJcbiAgICAgICAgc2xpZGVJZHggPSAxO1xyXG4gICAgfVxyXG4gICAgaWYoaWR4ID09IDApeyBzbGlkZUlkeCA9IHNsaWRlcy5sZW5ndGg7fVxyXG4gICAgZm9yIChpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgaWYoc2xpZGVzW2ldLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpe1xyXG4gICAgICAgICAgICBzbGlkZXNbaV0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHNsaWRlc1tzbGlkZUlkeC0xXS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgZG90c1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdkb3QtYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGRvdHNbc2xpZGVJZHgtMV0uY2xhc3NMaXN0LmFkZCgnZG90LWFjdGl2ZScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiJdLCJmaWxlIjoic2NyaXB0LmpzIn0=
